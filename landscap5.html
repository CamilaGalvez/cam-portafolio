<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/p5.js"></script>

<script>
 
let diameter;
let angle = 0;
let system;
let x = 0;
let y = 0;
let dim = 80.0;
let angle1 = 0;
let angle2 = 0;
let scalar = 70;




function setup() {
  createCanvas(800, 800);
  background(102, 189, 255);
  system = new ParticleSystem(createVector(-8, 350));
  diameter = 100;

  x = x + 0.5;
  if (x > width + dim) {
    x = -dim;
  }
  
  ///////////olas
  img = createImage(800, 360);
  img.loadPixels();
  img2 = createImage(800, 360);
  img2.loadPixels();
  img3 = createImage(800, 360);
  img3.loadPixels();
  img4 = createImage(800, 360);
  img4.loadPixels();
  //////////////////suelo
  img5 = createImage(800, 360);
  img5.loadPixels();
  img6 = createImage(800, 360);
  img6.loadPixels();
  img7 = createImage(800, 360);
  img7.loadPixels();
  img8 = createImage(800, 360);
  img8.loadPixels();

  
  
    ///////////olas////////////////////
  for (let x = 0; x < img.width; x++) {
  
      for (let y = 0; y < img.height; y++) {
	  
	  	if(2*Math.sin(x*0.08)+3*Math.sin(x*0.003) < y-100){
		
	    img.set(x, y, [10, 10*Math.sin(y*0.01), 250*Math.cos(y*0.01+105), 30]);
			
	}
	}
  
  img.updatePixels();

}

  for (let x = 0; x < img2.width; x++) {
  
      for (let y = 0; y < img2.height; y++) {
	  
	  	if(2*Math.cos(x*0.09)+3*Math.cos(x*0.005) < y-160){
		
	    img2.set(x, y, [0, 100, 200, 20]);
			
	  }
	 }
  
  img2.updatePixels();

}

  for (let x = 0; x < img3.width; x++) {
  
      for (let y = 0; y < img3.height; y++) {
	  
	  	if(2*Math.sin(x*0.09)+3*Math.sin(x*0.005) < y-220){
		
	    img3.set(x, y, [0, 115, 230, 20]);
			
	  }
	 }
  
  img3.updatePixels();

}

  for (let x = 0; x < img4.width; x++) {
  
      for (let y = 0; y < img4.height; y++) {
	  
	  	if(2*Math.cos(x*0.09)+3*Math.cos(x*0.05) < y-270){
		
	    img4.set(x, y, [0, 128, 255, 20]);
			
	  }
	 }
  
  img4.updatePixels();

}

  //////////////////suelo//////////////////


  for (let x = 0; x < img5.width; x++) {
  
      for (let y = 0; y < img5.height; y++) {
	  
	  	if(100*Math.atan(x*0.001) < y-10){
		
	    img5.set(x, y, [53, 98, 44, 255]);

	  }
	 }
  
  img5.updatePixels();

}

  for (let x = 0; x < img6.width; x++) {
  
      for (let y = 0; y < img6.height; y++) {
	  
	  	if(120*Math.atan(x*0.009+(1+Math.cos(x/1.8))) < y){
		
	    img6.set(x, y, [106, 83, 66, 255]);
			
	  }
	 }
  
  img6.updatePixels();

}

  for (let x = 0; x < img7.width; x++) {
  
      for (let y = 0; y < img7.height; y++) {
	  
	  	if(100*Math.atan(x*0.001) < y){
		
	    img7.set(x, y, [95, 76, 61, 255]);

	  }
	 }
  
  img7.updatePixels();

}

  for (let x = 0; x < img8.width; x++) {
  
      for (let y = 0; y < img8.height; y++) {
	  
	  	if(2.5*Math.sin(y*0.09)+2*Math.cos(y*0.005) > Math.sin(x)){
		
	    img8.set(x, y, [37, 150, 130, 6]);
			
	  }
	 }
  img8.updatePixels();

}


//////////////////sol/////////////////////////////
  var sun = color(255, 223, 129, 150);
  noStroke();
  
  for (i = 220; i > 0; i -= 30) {
    fill(sun);
    sun = lerpColor(sun, color(255, 215, 51), .25);
    ellipse(400, 350, i);
  }
}





//////////plantas///////
  function draw() {
   
  image(img, 0, 270);
  image(img2, 0, 270);
  image(img3, 0, 270);
  image(img4, 0, 270);
  image(img5, 0, 620);
  image(img6, 0, 630);
  image(img7, 0, 775);
  image(img8, 0, 372);
  
  
  
  system.addParticle();
  system.run();
  
  let ang1 = radians(angle1);
  let ang2 = radians(angle2);

  let x1 = width / 2 + scalar * cos(ang1);
  let x2 = width / 1.3 + scalar * cos(ang2);

  let y1 = height / 2 + scalar * sin(ang1);
  let y2 = height / 2 + scalar * sin(ang2);
  
  
  var level = 600;
  
  
  ///////////////////nubes
	
  fill(238, 247, 247);
  arc(450, 230, 180, 60, PI, TWO_PI);
  arc(430, 220, 60, 60, PI, TWO_PI);
  arc(500, 220, 60, 80, PI, TWO_PI);
  arc(470, 205, 85, 95, PI, TWO_PI);
  fill(238, 247, 247);
  arc(550, 230, 180, 60, PI, TWO_PI);
  arc(510, 220, 60, 60, PI, TWO_PI);
  arc(590, 220, 60, 80, PI, TWO_PI);
  arc(560, 210, 80, 80, PI, TWO_PI);
  
  fill(235, 235, 235);
  arc(450, 230, 120, 50, PI, TWO_PI);
  arc(430, 220, 40, 50, PI, TWO_PI);
  arc(500, 230, 40, 70, PI, TWO_PI);
  arc(470, 215, 65, 85, PI, TWO_PI);
  fill(235, 235, 235);
  arc(550, 230, 180, 50, PI, TWO_PI);
  arc(510, 220, 60, 50, PI, TWO_PI);
  arc(590, 220, 60, 70, PI, TWO_PI);
  arc(560, 210, 80, 70, PI, TWO_PI);
	
	
	
  fill(238, 247, 247);
  arc(180, 320, 180, 60, PI, TWO_PI);
  arc(160, 310, 60, 60, PI, TWO_PI);
  arc(230, 310, 60, 80, PI, TWO_PI);
  arc(200, 295, 85, 95, PI, TWO_PI);
  fill(238, 247, 247);
  arc(280, 320, 180, 60, PI, TWO_PI);
  arc(280, 310, 60, 60, PI, TWO_PI);
  arc(320, 310, 60, 80, PI, TWO_PI);
  arc(290, 300, 80, 80, PI, TWO_PI);
  
    fill(235, 235, 235);
  arc(170, 320, 160, 50, PI, TWO_PI);
  arc(150, 300, 40, 50, PI, TWO_PI);
  arc(220, 310, 40, 70, PI, TWO_PI);
  arc(190, 300, 65, 85, PI, TWO_PI);
  fill(235, 235, 235);
  arc(270, 320, 160, 50, PI, TWO_PI);
  arc(270, 310, 40, 50, PI, TWO_PI);
  arc(310, 310, 40, 70, PI, TWO_PI);
  arc(280, 300, 60, 70, PI, TWO_PI);
  
  
	//////tib
  fill(177, 177, 177);
  triangle(x1*+1.2+35, 390, x1*1.2+10, 415+x1*0.01, x1*1.2+40, 415);

  angle1 += 0.5;
  angle2 += 2;
	
	
	///////////suelo-tierra
		push();
  fill(53, 98, 44);
  noStroke();
  arc(380, 650, 915, 120, PI, TWO_PI);
  triangle(180, 650, 800, 650, 800, 720);
  		pop();
		push();
  fill(56, 109, 45);
  noStroke();
  ellipse(450, 640, 720, 120);
    triangle(180, 650, 800, 650, 800, 740);
		pop();
  
  //////////luz sol
  let d1 = 200 + (Math.sin(angle) * diameter) / 2 + diameter / 2;
  noStroke();
  fill(225, 223, 152, 2.1);
  ellipse(400, 350, d1, d1);
  angle -= Math.random(0.1);
  
  

	push();
	translate(800, 810);
	a(100)
	pop();

	push();
	translate(800, 810);
	a2(110)
	pop();
	 
	 
	push();
	translate(0, 70);
	a3(50)
	pop();

	push();
	translate(0, 20);
	a4(40)
	pop();
	
  } 
  
  
  
  
  
  /////////////cascada
  let Particle = function(position) {
  this.acceleration = createVector(0, 0.06);
  this.velocity = createVector(random(0.2, 0.8), random(-0.5, 0));
  this.position = position.copy();
  this.lifespan = 205;
};

Particle.prototype.run = function() {
  this.update();
  this.display();
};

// Method to update position
Particle.prototype.update = function(){
  this.velocity.add(this.acceleration);
  this.position.add(this.velocity);
  this.lifespan -= 1.5;
};

// Method to display
Particle.prototype.display = function() {
  stroke(255, this.lifespan);
  strokeWeight(0.2);
  fill(91, 160, 228, this.lifespan);
  ellipse(this.position.x, this.position.y, 5, 8);
};

// Is the particle still useful?
Particle.prototype.isDead = function(){
  return this.lifespan < 80;
};

let ParticleSystem = function(position) {
  this.origin = position.copy();
  this.particles = [];
};

ParticleSystem.prototype.addParticle = function() {
  this.particles.push(new Particle(this.origin));
};

ParticleSystem.prototype.run = function() {
  for (let i = this.particles.length-50; i >= 0; i--) {
    let p = this.particles[i];
    p.run();
    if (p.isDead()) {
      this.particles.splice(1, i);
    }
  }
};

  
  
  

/////////////////////rama1
	 function a(L) {

	line(0, 0, 0, -L);
	translate(0, -L);

	if (L > 3.5) {
rotate(radians(20))
		push();
		stroke(L*70, L*150, 90, L*4);
		strokeWeight(L*0.13);
		rotate(radians(-80))
		a(L*0.3)
		pop();

		push();
		stroke(65, 151, 47, L*4);
		strokeWeight(L*0.1);
		rotate(radians(-40))
		a(L*0.9)
		pop();
	}
}

////////////////////rama2
function a2(L) {

	line(0, 0, 0, -L);
	translate(0, -L);

	if (L > 3.5) {
rotate(radians(20))

		push();
		stroke(L*70, L*150, 90, L*4);
		strokeWeight(L*0.15);
		rotate(radians(-80))
		a2(L*0.3)
		pop();

		push();
		stroke(65, 151, 47, L*4);
		strokeWeight(L*0.1);
		rotate(radians(-30))
		a2(L*0.9)
		pop();
		
	}
}

/////////////////////rama3
	 function a3(L) {

	line(0, 0, 0, -L);
	translate(0, -L);

	if (L > 3.5) {
rotate(radians(110))
		push();
		stroke(L*50, L*50, 90, L*4);
		strokeWeight(L*0.13);
		rotate(radians(60))
		a(L*0.3)
		pop();

		push();
		stroke(65, 151, 47, L*4);
		strokeWeight(L*0.1);
		rotate(radians(50))
		a(L*0.8)
		pop();
		

	}
}

////////////////////rama4
function a4(L) {

	line(0, 0, 0, -L);
	translate(0, -L);

	if (L > 3.5) {
rotate(radians(-110))

		push();
		stroke(L*70, L*150, 90, L*4);
		strokeWeight(L*0.15);
		rotate(radians(-60))
		a2(L*0.3)
		pop();

		push();
		stroke(65, 151, 47, L*4);
		strokeWeight(L*0.1);
		rotate(radians(-60))
		a2(L*0.9)
		pop();
		
	}
}

</script>